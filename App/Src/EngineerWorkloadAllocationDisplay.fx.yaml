EngineerWorkloadAllocationDisplay As screen:

    "ProjectListAllocationTabel As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
        BorderThickness: =
        DelayItemLoading: =true
        Height: =290
        Items: =ProjectDataTable
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =55
        Width: =1342
        X: =12
        Y: =200
        ZIndex: =1

        Separator3 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =1

        ProjectListAllocation_Pipeline As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =Switch(
                    Lower(ThisItem.Pipeline),
                    "internal",
                    Color.SkyBlue,
                    "future",
                    Color.Orange,
                    "target",
                    Color.Violet,
                    "sold",
                    Color.Black,
                    Color.Transparent
                )
            Height: =50
            Size: =10
            Text: =ThisItem.Pipeline
            Width: =60
            X: =3
            Y: =4
            ZIndex: =2

        ProjectListAllocation_BU As label:
            Align: =Align.Center
            Fill: =Switch(Lower(ThisItem.BU),"dt", Color.CornflowerBlue,"ht", Color.LightCoral,"ls",Color.LimeGreen, Color.Transparent)
            Height: =50
            Size: =8
            Text: =ThisItem.BU
            Width: =25
            X: =63
            Y: =4
            ZIndex: =3

        ProjectListAllocation_Team As label:
            Align: =Align.Center
            Height: =50
            Size: =8
            Text: =ThisItem.Team
            Width: =40
            X: =88
            Y: =4
            ZIndex: =4

        ProjectListAllocation_Project As label:
            Height: =50
            Size: =9
            Text: =ThisItem.Project
            Width: =60
            X: =128
            Y: =3
            ZIndex: =5

        ProjectListAllocation_Description As label:
            Height: =50
            Size: =8
            Text: =ThisItem.Description
            Width: =125
            X: =188
            Y: =3
            ZIndex: =6

        ProjectListAllocation_Account As label:
            Height: =50
            Size: =10
            Text: =ThisItem.Account
            Width: =75
            X: =313
            Y: =3
            ZIndex: =7

        ProjectListAllocation_PL As label:
            Align: =Align.Center
            Height: =50
            Size: =9
            Text: =ThisItem.PL
            Width: =40
            X: =388
            Y: =3
            ZIndex: =8

        ProjectListAllocation_SWBooking As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    ThisItem.'SW Bookings' > (ThisItem.'Value (£k)' * ThisItem.'% SW' * 1.2),
                    Color.LightGreen,
                    ThisItem.'SW Bookings' < (ThisItem.'Value (£k)' * ThisItem.'% SW' * 0.8),
                    Color.LightCoral,
                    Color.Transparent
                )
            Height: =50
            Size: =10
            Text: |-
                =If(
                    IsBlank(ThisItem.'SW Bookings'),
                    "0",
                    ThisItem.'SW Bookings'
                )
            Width: =75
            X: =428
            Y: =3
            ZIndex: =9

        ProjectListAllocation_Value As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Lighter
            Height: =50
            Size: =8
            Text: =ThisItem.'Value (£k)'
            Width: =37
            X: =503
            Y: =3
            ZIndex: =10

        ProjectListAllocation_Remaining As label:
            Align: =Align.Center
            Height: =50
            Size: =8
            Text: =ThisItem.'Remaining (£k)'
            Width: =37
            X: =540
            Y: =3
            ZIndex: =11

        ProjectListAllocation_Discount As label:
            Align: =Align.Center
            Height: =50
            Size: =10
            Text: =If(!IsBlank(ThisItem.'Fees Discount'),Text((-ThisItem.'Fees Discount' * 100) & "%"))
            Width: =37
            X: =577
            Y: =3
            ZIndex: =12

        ProjectListAllocation_PerSW As label:
            Align: =Align.Center
            Height: =50
            Size: =7
            Text: =Text((ThisItem.'% SW' * 100) & "%")
            Width: =37
            X: =614
            Y: =3
            ZIndex: =13

        ProjectListAllocation_Duration As label:
            Align: =Align.Center
            Height: =50
            Size: =11
            Text: =ThisItem.'Duration Mo'
            Width: =37
            X: =651
            Y: =3
            ZIndex: =14

        ProjectListAllocation_SaleDate As label:
            Align: =Align.Center
            Height: =50
            Size: =9
            Text: =Text(ThisItem.'Sale Date', "mm/yy")
            Width: =45
            X: =692
            Y: =3
            ZIndex: =15

        ProjectListAllocation_StartDate As label:
            Align: =Align.Center
            Height: =50
            Size: =9
            Text: =Text(ThisItem.'Start Date', "mm/yy")
            Width: =45
            X: =737
            Y: =3
            ZIndex: =16

        ProjectListAllocation_EndDate As label:
            Align: =Align.Center
            Height: =50
            Size: =9
            Text: =Text(ThisItem.'End Date', "mm/yy")
            Width: =45
            X: =782
            Y: =3
            ZIndex: =17

        ProjectListAllocation_Probablility As label:
            Align: =Align.Center
            Height: =50
            Size: =7
            Text: =Text((ThisItem.'Prob.' * 100) & "%")
            Width: =37
            X: =827
            Y: =3
            ZIndex: =18

        ProjectListAllocation_Month_1 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation1MonthNum And Year = allocation1Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation1MonthNum And Year = allocation1Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month1
            Width: =40
            X: =865
            Y: =3
            ZIndex: =19

        ProjectListAllocation_Month_2 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation2MonthNum And Year = allocation2Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation2MonthNum And Year = allocation2Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month2
            Width: =40
            X: =904
            Y: =3
            ZIndex: =20

        ProjectListAllocation_Month_3 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation3MonthNum And Year = allocation3Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation3MonthNum And Year = allocation3Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month3
            Width: =40
            X: =944
            Y: =3
            ZIndex: =21

        ProjectListAllocation_Month_4 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation4MonthNum And Year = allocation4Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation4MonthNum And Year = allocation4Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month4
            Width: =40
            X: =984
            Y: =3
            ZIndex: =22

        ProjectListAllocation_Month_5 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation5MonthNum And Year = allocation5Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation5MonthNum And Year = allocation5Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month5
            Width: =40
            X: =1024
            Y: =3
            ZIndex: =23

        ProjectListAllocation_Month_6 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation6MonthNum And Year = allocation6Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation6MonthNum And Year = allocation6Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month6
            Width: =40
            X: =1064
            Y: =3
            ZIndex: =24

        ProjectListAllocation_Month_7 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation7MonthNum And Year = allocation7Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation7MonthNum And Year = allocation7Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month7
            Width: =40
            X: =1104
            Y: =3
            ZIndex: =25

        ProjectListAllocation_Month_8 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation8MonthNum And Year = allocation8Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation8MonthNum And Year = allocation8Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month8
            Width: =40
            X: =1144
            Y: =3
            ZIndex: =26

        ProjectListAllocation_Month_9 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation9MonthNum And Year = allocation9Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation9MonthNum And Year = allocation9Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month9
            Width: =40
            X: =1184
            Y: =3
            ZIndex: =27

        ProjectListAllocation_Month_10 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation10MonthNum And Year = allocation10Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation10MonthNum And Year = allocation10Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month10
            Width: =40
            X: =1224
            Y: =3
            ZIndex: =28

        ProjectListAllocation_Month_11 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation11MonthNum And Year = allocation11Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation11MonthNum And Year = allocation11Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month11
            Width: =40
            X: =1264
            Y: =3
            ZIndex: =29

        ProjectListAllocation_Month_12 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Self.Fill = Color.Black,
                    Color.White,
                    Color.Black
                )
            Fill: |-
                =If(
                    IsBlank(Self.Text),
                    Color.Transparent,
                    
                    If(
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation12MonthNum And Year = allocation12Year,
                                Month
                            )
                        ) < Month(Today())
                        And
                        Int(
                            LookUp(
                                ProjectAllocation,
                                Project = ThisItem.Project And Value(Month) = allocation12MonthNum And Year = allocation12Year,
                                Year
                            )
                        ) <= Year(Today()),
                        Color.Gray,
                        Switch(
                            Lower(ThisItem.Pipeline),
                            "internal",
                            Color.SkyBlue,
                            "future",
                            Color.Orange,
                            "target",
                            Color.Violet,
                            "sold",
                            Color.Black,
                            Color.Transparent
                        )
                    )
                )
            Height: =50
            OnSelect: =Select(Parent)
            Size: =10
            Text: =LookUp(FormattedProjectAllocationTable, Project = ThisItem.Project).Month12
            Width: =40
            X: =1302
            Y: =3
            ZIndex: =30

    "WorkloadAllocationTable As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =173
        Items: =FormattedAllocationTable
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =FormattedAllocationTable
        TemplatePadding: =0
        TemplateSize: =43
        Width: =1366
        Y: =565
        ZIndex: =1

        WorkloadAllocation_Person As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(50, 49, 48, 1)
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: |
                =32
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =14
            Text: =ThisItem.PersonName
            Width: =197
            X: =19
            Y: =4
            ZIndex: =1

        Separator1 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =3

        WorloadAllocation_Project As label:
            Height: |
                =32
            OnSelect: =Select(Parent)
            Text: =ThisItem.ProjectName
            Width: =253
            X: =232
            Y: =4
            ZIndex: =5

        WorkloadAllocation_Month1_Input As text:
            Align: =Align.Center
            Default: =ThisItem.Month1
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation1MonthNum
                );
                Set(
                    YearAllocation,
                    allocation1Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month1Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month1
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month1
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =874
            Y: =4
            ZIndex: =18

        WorkloadAllocation_Month2_Input As text:
            Align: =Align.Center
            Default: =ThisItem.Month2
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation2MonthNum
                );
                Set(
                    YearAllocation,
                    allocation2Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month2Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month2
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month2
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =914
            Y: =4
            ZIndex: =19

        WorkloadAllocation_Month3_Input As text:
            Align: =Align.Center
            Default: =ThisItem.Month3
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation3MonthNum
                );
                Set(
                    YearAllocation,
                    allocation3Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month3Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month3
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month3
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =954
            Y: =4
            ZIndex: =20

        WorkloadAllocation_Month3_Input_1 As text:
            Align: =Align.Center
            Default: =ThisItem.Month4
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)),
                    Color.Transparent,
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    Color.Transparent
                )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation4MonthNum
                );
                Set(
                    YearAllocation,
                    allocation4Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month4Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month4
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month4
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =994
            Y: =4
            ZIndex: =21

        WorkloadAllocation_Month3_Input_2 As text:
            Align: =Align.Center
            Default: =ThisItem.Month5
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation5MonthNum
                );
                Set(
                    YearAllocation,
                    allocation5Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month5Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month5
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month5
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1034
            Y: =4
            ZIndex: =22

        WorkloadAllocation_Month3_Input_4 As text:
            Align: =Align.Center
            Default: =ThisItem.Month6
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation6MonthNum
                );
                Set(
                    YearAllocation,
                    allocation6Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month6Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month6
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month6
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1074
            Y: =4
            ZIndex: =23

        WorkloadAllocation_Month3_Input_5 As text:
            Align: =Align.Center
            Default: =ThisItem.Month7
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation7MonthNum
                );
                Set(
                    YearAllocation,
                    allocation7Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month7Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month7
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month7
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1114
            Y: =4
            ZIndex: =24

        WorkloadAllocation_Month3_Input_6 As text:
            Align: =Align.Center
            Default: =ThisItem.Month8
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation8MonthNum
                );
                Set(
                    YearAllocation,
                    allocation8Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month8Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month8
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month8
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1154
            Y: =4
            ZIndex: =25

        WorkloadAllocation_Month3_Input_7 As text:
            Align: =Align.Center
            Default: =ThisItem.Month9
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation9MonthNum
                );
                Set(
                    YearAllocation,
                    allocation9Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month9Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month9
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month9
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1194
            Y: =4
            ZIndex: =26

        WorkloadAllocation_Month3_Input_8 As text:
            Align: =Align.Center
            Default: =ThisItem.Month10
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation10MonthNum
                );
                Set(
                    YearAllocation,
                    allocation10Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month10Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month10
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month10
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1234
            Y: =4
            ZIndex: =27

        WorkloadAllocation_Month3_Input_9 As text:
            Align: =Align.Center
            Default: =ThisItem.Month11
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation11MonthNum
                );
                Set(
                    YearAllocation,
                    allocation11Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month11Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month11
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month11
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1274
            Y: =4
            ZIndex: =28

        WorkloadAllocation_Month3_Input_10 As text:
            Align: =Align.Center
            Default: =ThisItem.Month12
            Fill: |-
                =If(
                    IsBlank(Value(Self.Text)), 
                    Color.Transparent,
                
                    Value(Self.Text) <= 0.33,
                    Color.LightGreen,
                    
                    Value(Self.Text) <= 0.66,
                    Color.SandyBrown,
                    
                    Value(Self.Text) > 0.66,
                    Color.PaleVioletRed,
                    
                    Color.Transparent )
            Format: =TextFormat.Number
            Height: =32
            OnChange: |-
                =Set(
                    MonthAllocation,
                    allocation12MonthNum
                );
                Set(
                    YearAllocation,
                    allocation12Year
                );
                Set(
                    CHECKID,
                    ThisItem.AllocationID
                );
                If(
                    IsBlank(Self.Text),
                    Remove(
                        EngineerAllocation,
                        LookUp(
                            EngineerAllocation,
                            AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                        )
                    ),
                    Patch(
                        EngineerAllocation,
                        If(
                            IsEmpty(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            ),
                            Defaults(EngineerAllocation),
                            First(
                                Filter(
                                    EngineerAllocation,
                                    AllocationID = CHECKID And Month = Text(MonthAllocation) And Year = YearAllocation
                                )
                            )
                        ),
                        {
                            AllocationID: CHECKID,
                            Month: Text(MonthAllocation),
                            Year: YearAllocation,
                            Allocation: Self.Text
                        }
                    );
                    
                );
                //Add all columns from another table code
                ClearCollect(
                    TempTable1,
                    AddColumns(
                        EngineerAllocation,
                        PersonID,
                        LookUp(
                            EngineerProjects,
                            AllocationID = EngineerAllocation[@AllocationID],
                            PersonID
                        )
                    )
                );
                ClearCollect(
                    TempTable2,
                    AddColumns(
                        TempTable1,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = TempTable1[@AllocationID],
                            Projects
                        )
                    )
                );
                ClearCollect(
                    JoinedAllocationTable,
                    AddColumns(
                        TempTable2,
                        PersonName,
                        LookUp(
                            Engineers,
                            PersonID = TempTable2[@PersonID],
                            Name
                        )
                    )
                );
                ClearCollect(
                    FilteredJoinedAllocationTable,
                    If(
                        !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                        ),
                        !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            PersonName in SelectedEngineers.Value
                        ),
                        IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                        Filter(
                            JoinedAllocationTable,
                            Projects in SelectedProjects.Value
                        ),
                        JoinedAllocationTable
                    )
                );
                Clear(TempTable1);
                Clear(TempTable2);
                ClearCollect(
                    SplitAllocationTable,
                    ForAll(
                        FilteredJoinedAllocationTable,
                        {
                            AllocationID: ThisRecord.AllocationID,
                            PersonName: ThisRecord.PersonName,
                            ProjectName: ThisRecord.Projects,
                            Month1: If(
                                Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                                ThisRecord.Allocation
                            ),
                            Month2: If(
                                Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                                ThisRecord.Allocation
                            ),
                            Month3: If(
                                Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                                ThisRecord.Allocation
                            ),
                            Month4: If(
                                Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                                ThisRecord.Allocation
                            ),
                            Month5: If(
                                Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                                ThisRecord.Allocation
                            ),
                            Month6: If(
                                Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                                ThisRecord.Allocation
                            ),
                            Month7: If(
                                Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                                ThisRecord.Allocation
                            ),
                            Month8: If(
                                Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                                ThisRecord.Allocation
                            ),
                            Month9: If(
                                Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                                ThisRecord.Allocation
                            ),
                            Month10: If(
                                Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                                ThisRecord.Allocation
                            ),
                            Month11: If(
                                Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                                ThisRecord.Allocation
                            ),
                            Month12: If(
                                Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                                ThisRecord.Allocation
                            )
                        }
                    )
                );
                ClearCollect(
                    FormattedAllocationTable,
                    Sort(
                        Sort(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    AddColumns(
                                                                        (AddColumns(
                                                                            GroupBy(
                                                                                SplitAllocationTable,
                                                                                AllocationID,
                                                                                PersonName,
                                                                                ProjectName,
                                                                                subgroup
                                                                            ),
                                                                            Month1,
                                                                            Sum(
                                                                                subgroup,
                                                                                Value(Month1)
                                                                            )
                                                                        )),
                                                                        Month2,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month2)
                                                                        )
                                                                    ),
                                                                    Month3,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month3)
                                                                    )
                                                                ),
                                                                Month4,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month4)
                                                                )
                                                            ),
                                                            Month5,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month5)
                                                            )
                                                        ),
                                                        Month6,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month6)
                                                        )
                                                    ),
                                                    Month7,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month7)
                                                    )
                                                ),
                                                Month8,
                                                Sum(
                                                    subgroup,
                                                    Value(Month8)
                                                )
                                            ),
                                            Month9,
                                            Sum(
                                                subgroup,
                                                Value(Month9)
                                            )
                                        ),
                                        Month10,
                                        Sum(
                                            subgroup,
                                            Value(Month10)
                                        )
                                    ),
                                    Month11,
                                    Sum(
                                        subgroup,
                                        Value(Month11)
                                    )
                                ),
                                Month12,
                                Sum(
                                    subgroup,
                                    Value(Month12)
                                )
                            ),
                            ProjectName
                        ),
                        PersonName
                    )
                );
                Set(
                    Month12Total,
                    If(
                        !IsBlank(
                            Sum(
                                FormattedAllocationTable,
                                Month12
                            )
                        ),
                        Text(
                            Sum(
                                FormattedAllocationTable,
                                Month12
                            )
                        ),
                        ""
                    )
                )
            OnSelect: =Select(Parent)
            Size: =10
            Width: =40
            X: =1314
            Y: =4
            ZIndex: =29

    WorkloadAllocation_HeaderLabels As groupContainer.horizontalAutoLayoutContainer:
        Height: =30
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutJustifyContent: =LayoutJustifyContent.End
        LayoutMode: =LayoutMode.Auto
        Width: =1342
        X: =12
        Y: =535
        ZIndex: =2

        WorkloadAllocation_Engineer_Label As label:
            Height: =30
            Text: |-
                ="Engineer
                "
            Width: =220
            ZIndex: =1

        WorkloadAllocation_Project_Label As label:
            Height: =30
            Text: |-
                ="Project
                "
            Width: =640
            ZIndex: =2

        WorkloadAllocation_Month1_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation1MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month1"
                )
            Width: =40
            X: =505
            Y: =152
            ZIndex: =3

        WorkloadAllocation_Month2_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation2MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month2"
                )
            Width: =40
            X: =71
            Y: =152
            ZIndex: =4

        WorkloadAllocation_Month3_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation3MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                "Month3"
                )
            Width: =40
            X: =142
            Y: =152
            ZIndex: =5

        WorkloadAllocation_Month4_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation4MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month4"
                )
            Width: =40
            X: =213
            Y: =152
            ZIndex: =6

        WorkloadAllocation_Month5_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation5MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month5"
                )
            Width: =40
            X: =284
            Y: =152
            ZIndex: =7

        WorkloadAllocation_Month6_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation6MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month6"
                )
            Width: =40
            X: =355
            Y: =152
            ZIndex: =8

        WorkloadAllocation_Month7_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation7MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month7"
                )
            Width: =40
            X: =423
            Y: =152
            ZIndex: =9

        WorkloadAllocation_Month8_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation8MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month8"
                )
            Width: =40
            X: =494
            Y: =152
            ZIndex: =10

        WorkloadAllocation_Month9_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation9MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month9"
                )
            Width: =40
            X: =565
            Y: =152
            ZIndex: =11

        WorkloadAllocation_Month10_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation10MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month10"
                )
            Width: =40
            X: =636
            Y: =152
            ZIndex: =12

        WorkloadAllocation_Month11_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation11MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month11"
                )
            Width: =40
            X: =707
            Y: =152
            ZIndex: =13

        WorkloadAllocation_Month12_Label As label:
            Align: =Align.Center
            Fill: =Color.Transparent
            Height: =30
            Size: =11
            Text: |-
                =Switch(allocation12MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month12"
                )
            Width: =40
            X: =778
            Y: =152
            ZIndex: =14

    WorkloadAllocation_YearContainer As groupContainer.manualLayoutContainer:
        Height: =51
        Width: =315
        X: =254
        Y: =40
        ZIndex: =3

        WorkloadAllocation_YearText_Label As label:
            Height: =41
            Text: |-
                ="Displaying:"
            Width: =108
            X: =15
            Y: =6
            ZIndex: =1

        WorkloadAllocation_Date_Label As label:
            Text: =allocation1MonthNum & " / " &allocation1Year & "  -  " & allocation12MonthNum & " / " & allocation12Year
            Width: =185
            X: =123
            Y: =7
            ZIndex: =2

    SelectEngineer_Combo As combobox:
        DisplayFields: =["Value"]
        Height: =31
        InputTextPlaceholder: ="Choose Engineers..."
        Items: |-
            =If(
                !IsEmpty(SelectedProjects),
                Distinct(
                    Filter(
                        JoinedAllocationTable, 
                        Projects in SelectedProjects
                    ), PersonName
                ),
                Distinct(
                    JoinedAllocationTable, PersonName
                )
            )
        OnChange: |-
            =ClearCollect(SelectedEngineers, Self.SelectedItems);
            
            //Add all columns from another table code
            
            ClearCollect(TempTable1, 
                AddColumns(
                    EngineerAllocation,
                    PersonID,
                    LookUp(EngineerProjects, AllocationID = EngineerAllocation[@AllocationID], PersonID))
            );
            
            ClearCollect(TempTable2,   
                AddColumns(
                    TempTable1,
                    Projects,
                    LookUp(EngineerProjects, AllocationID = TempTable1[@AllocationID], Projects))
            );
            
            ClearCollect(JoinedAllocationTable,
                AddColumns(
                    TempTable2,
                    PersonName,
                    LookUp(Engineers, PersonID = TempTable2[@PersonID], Name))
            );
            
            
            ClearCollect(FilteredJoinedAllocationTable, If(!IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value),
                                                            !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value),
                                                            IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, Projects in SelectedProjects.Value), 
                                                            JoinedAllocationTable));
            
            Clear(TempTable1);
            Clear(TempTable2);
            
            
            ClearCollect(SplitAllocationTable, ForAll(FilteredJoinedAllocationTable, {AllocationID: ThisRecord.AllocationID,
                                                                                PersonName:ThisRecord.PersonName,
                                                                                ProjectName:ThisRecord.Projects,
                                                                                Month1: If(Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year, ThisRecord.Allocation),
                                                                                Month2: If(Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year, ThisRecord.Allocation),
                                                                                Month3: If(Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year, ThisRecord.Allocation),
                                                                                Month4: If(Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year, ThisRecord.Allocation),
                                                                                Month5: If(Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year, ThisRecord.Allocation),
                                                                                Month6: If(Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year, ThisRecord.Allocation),
                                                                                Month7: If(Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year, ThisRecord.Allocation),
                                                                                Month8: If(Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year, ThisRecord.Allocation),
                                                                                Month9: If(Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year, ThisRecord.Allocation),
                                                                                Month10: If(Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year, ThisRecord.Allocation),
                                                                                Month11: If(Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year, ThisRecord.Allocation),
                                                                                Month12: If(Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year, ThisRecord.Allocation)}));
            
            ClearCollect(FormattedAllocationTable,
                Sort(
                    Sort(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(    
                                                    AddColumns(    
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    (
                                                                        AddColumns(
                                                                            GroupBy(SplitAllocationTable,AllocationID,PersonName,ProjectName,subgroup), Month1, Sum(subgroup,Value(Month1))
                                                                        )
                                                                    ), Month2, Sum(subgroup,Value(Month2))
                                                                ), Month3, Sum(subgroup,Value(Month3))
                                                            ), Month4, Sum(subgroup,Value(Month4))
                                                        ), Month5, Sum(subgroup,Value(Month5))
                                                    ), Month6, Sum(subgroup,Value(Month6))
                                                ), Month7, Sum(subgroup,Value(Month7))
                                            ), Month8, Sum(subgroup,Value(Month8))
                                        ), Month9, Sum(subgroup,Value(Month9))
                                    ), Month10, Sum(subgroup,Value(Month10))
                                ), Month11, Sum(subgroup,Value(Month11))
                            ),Month12, Sum(subgroup,Value(Month12))
                        ), ProjectName
                    ), PersonName
                )
            );
            Set(
                Month1Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    ""
                )
            );
            
            Set(
                Month2Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    ""
                )
            );
            Set(
                Month3Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    ""
                )
            );
            Set(
                Month4Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    ""
                )
            );
            Set(
                Month5Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    ""
                )
            );
            Set(
                Month6Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    ""
                )
            );
            Set(
                Month7Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    ""
                )
            );
            Set(
                Month8Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    ""
                )
            );
            Set(
                Month9Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    ""
                )
            );
            Set(
                Month10Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    ""
                )
            );
            Set(
                Month11Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    ""
                )
            );
            Set(
                Month12Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    ""
                )
            );
        Reset: =true
        SearchFields: =["Value"]
        SearchItems: =Search(If(!IsEmpty(SelectedProjects),Distinct(Filter(JoinedAllocationTable,Projects in SelectedProjects),PersonName),Distinct(JoinedAllocationTable,PersonName)),SelectEngineer_Combo.SearchText,Value)
        Size: =10
        Width: =216
        X: =12
        Y: =498
        ZIndex: =4

    SelectProject_Combo As combobox:
        ChevronFill: =Color.White
        DisplayFields: =["Value"]
        Height: =31
        InputTextPlaceholder: ="Choose Projects..."
        Items: |-
            =If(
                !IsEmpty(SelectedEngineers),
                Distinct(
                    Filter(
                        JoinedAllocationTable, 
                        PersonName in SelectedEngineers
                    ), Projects
                ),
                Distinct(
                    JoinedAllocationTable, Projects
                )
            )
        OnChange: |-
            =ClearCollect(SelectedProjects, Self.SelectedItems);
            
            //Add all columns from another table code
            
            ClearCollect(TempTable1, 
                AddColumns(
                    EngineerAllocation,
                    PersonID,
                    LookUp(EngineerProjects, AllocationID = EngineerAllocation[@AllocationID], PersonID))
            );
            
            ClearCollect(TempTable2,   
                AddColumns(
                    TempTable1,
                    Projects,
                    LookUp(EngineerProjects, AllocationID = TempTable1[@AllocationID], Projects))
            );
            
            ClearCollect(JoinedAllocationTable,
                AddColumns(
                    TempTable2,
                    PersonName,
                    LookUp(Engineers, PersonID = TempTable2[@PersonID], Name))
            );
            
            
            ClearCollect(FilteredJoinedAllocationTable, If(!IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value),
                                                            !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value),
                                                            IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, Projects in SelectedProjects.Value), 
                                                            JoinedAllocationTable));
            
            Clear(TempTable1);
            Clear(TempTable2);
            
            
            ClearCollect(SplitAllocationTable, ForAll(FilteredJoinedAllocationTable, {AllocationID: ThisRecord.AllocationID,
                                                                                PersonName:ThisRecord.PersonName,
                                                                                ProjectName:ThisRecord.Projects,
                                                                                Month1: If(Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year, ThisRecord.Allocation),
                                                                                Month2: If(Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year, ThisRecord.Allocation),
                                                                                Month3: If(Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year, ThisRecord.Allocation),
                                                                                Month4: If(Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year, ThisRecord.Allocation),
                                                                                Month5: If(Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year, ThisRecord.Allocation),
                                                                                Month6: If(Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year, ThisRecord.Allocation),
                                                                                Month7: If(Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year, ThisRecord.Allocation),
                                                                                Month8: If(Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year, ThisRecord.Allocation),
                                                                                Month9: If(Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year, ThisRecord.Allocation),
                                                                                Month10: If(Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year, ThisRecord.Allocation),
                                                                                Month11: If(Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year, ThisRecord.Allocation),
                                                                                Month12: If(Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year, ThisRecord.Allocation)}));
            
            ClearCollect(FormattedAllocationTable,
                Sort(
                    Sort(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(    
                                                    AddColumns(    
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    (
                                                                        AddColumns(
                                                                            GroupBy(SplitAllocationTable,AllocationID,PersonName,ProjectName,subgroup), Month1, Sum(subgroup,Value(Month1))
                                                                        )
                                                                    ), Month2, Sum(subgroup,Value(Month2))
                                                                ), Month3, Sum(subgroup,Value(Month3))
                                                            ), Month4, Sum(subgroup,Value(Month4))
                                                        ), Month5, Sum(subgroup,Value(Month5))
                                                    ), Month6, Sum(subgroup,Value(Month6))
                                                ), Month7, Sum(subgroup,Value(Month7))
                                            ), Month8, Sum(subgroup,Value(Month8))
                                        ), Month9, Sum(subgroup,Value(Month9))
                                    ), Month10, Sum(subgroup,Value(Month10))
                                ), Month11, Sum(subgroup,Value(Month11))
                            ),Month12, Sum(subgroup,Value(Month12))
                        ), ProjectName
                    ), PersonName
                )
            );
            Set(
                Month1Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    ""
                )
            );
            
            Set(
                Month2Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    ""
                )
            );
            Set(
                Month3Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    ""
                )
            );
            Set(
                Month4Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    ""
                )
            );
            Set(
                Month5Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    ""
                )
            );
            Set(
                Month6Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    ""
                )
            );
            Set(
                Month7Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    ""
                )
            );
            Set(
                Month8Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    ""
                )
            );
            Set(
                Month9Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    ""
                )
            );
            Set(
                Month10Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    ""
                )
            );
            Set(
                Month11Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    ""
                )
            );
            Set(
                Month12Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    ""
                )
            );
        Reset: =true
        SearchFields: =["Value"]
        SearchItems: =Search(If(!IsEmpty(SelectedEngineers),Distinct(Filter(JoinedAllocationTable,PersonName in SelectedEngineers),Projects),Distinct(JoinedAllocationTable,Projects)),SelectProject_Combo.SearchText,Value)
        Size: |
            =10
        Width: =215
        X: =228
        Y: =498
        ZIndex: =5

    WorkAllocation_TotalsContainer As groupContainer.manualLayoutContainer:
        Height: =30
        Width: =1342
        X: =12
        Y: =738
        ZIndex: =6

        WorkloadAllocation_Month1_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month1Total
            Width: =40
            X: =863
            ZIndex: =1

        WorkloadAllocation_Month2_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month2Total
            Width: =40
            X: =903
            ZIndex: =2

        WorkloadAllocation_Month3_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month3Total
            Width: =40
            X: =943
            ZIndex: =3

        WorkloadAllocation_Month4_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month4Total
            Width: =40
            X: =983
            ZIndex: =4

        WorkloadAllocation_Month5_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month5Total
            Width: =40
            X: =1023
            ZIndex: =5

        WorkloadAllocation_Month6_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month6Total
            Width: =40
            X: =1063
            ZIndex: =6

        WorkloadAllocation_Month7_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month7Total
            Width: =40
            X: =1103
            ZIndex: =7

        WorkloadAllocation_Month8_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month8Total
            Width: =40
            X: =1142
            ZIndex: =8

        WorkloadAllocation_Month9_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month9Total
            Width: =40
            X: =1182
            ZIndex: =9

        WorkloadAllocation_Month10_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month10Total
            Width: =40
            X: =1222
            ZIndex: =10

        WorkloadAllocation_Month11_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month11Total
            Width: =40
            X: =1262
            ZIndex: =11

        WorkloadAllocation_Month12_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =11
            Text: =Month12Total
            Width: =40
            X: =1302
            ZIndex: =12

    WorkAllocation_BackMonth_Button As icon.ArrowLeft:
        Height: =50
        Icon: =Icon.ArrowLeft
        OnSelect: |
            =UpdateContext(
                {
                    Allocation_SelectedDate: DateAdd(
                        Coalesce(
                            Allocation_SelectedDate,
                            Today()
                        ),
                        -1,
                        TimeUnit.Months
                    )
                }
            );
            Set(
                allocation1MonthText,
                Text(
                    Allocation_SelectedDate,
                    "mmmm"
                )
            );
            Set(
                allocation1MonthNum,
                Int(
                    Text(
                        Allocation_SelectedDate,
                        "mm"
                    )
                )
            );
            Set(
                allocation1Year,
                Text(
                    Allocation_SelectedDate,
                    "yyyy"
                )
            );
            Set(
                allocation2MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        1,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation2MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            1,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation2Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        1,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation3MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        2,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation3MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            2,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation3Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        2,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation4MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        3,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation4MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            3,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation4Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        3,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation5MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        4,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation5MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            4,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation5Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        4,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation6MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        5,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation6MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            5,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation6Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        5,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation7MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        6,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation7MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            6,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation7Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        6,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation8MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        7,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation8MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            7,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation8Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        7,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation9MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        8,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation9MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            8,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation9Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        8,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation10MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        9,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation10MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            9,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation10Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        9,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation11MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        10,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation11MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            10,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation11Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        10,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            Set(
                allocation12MonthText,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        11,
                        TimeUnit.Months
                    ),
                    "mmmm"
                )
            );
            Set(
                allocation12MonthNum,
                Int(
                    Text(
                        DateAdd(
                            Allocation_SelectedDate,
                            11,
                            TimeUnit.Months
                        ),
                        "mm"
                    )
                )
            );
            Set(
                allocation12Year,
                Text(
                    DateAdd(
                        Allocation_SelectedDate,
                        11,
                        TimeUnit.Months
                    ),
                    "yyyy"
                )
            );
            //Add all columns from another table code
            ClearCollect(
                TempTable1,
                AddColumns(
                    EngineerAllocation,
                    PersonID,
                    LookUp(
                        EngineerProjects,
                        AllocationID = EngineerAllocation[@AllocationID],
                        PersonID
                    )
                )
            );
            ClearCollect(
                TempTable2,
                AddColumns(
                    TempTable1,
                    Projects,
                    LookUp(
                        EngineerProjects,
                        AllocationID = TempTable1[@AllocationID],
                        Projects
                    )
                )
            );
            ClearCollect(
                JoinedAllocationTable,
                AddColumns(
                    TempTable2,
                    PersonName,
                    LookUp(
                        Engineers,
                        PersonID = TempTable2[@PersonID],
                        Name
                    )
                )
            );
            ClearCollect(
                FilteredJoinedAllocationTable,
                If(
                    !IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                    Filter(
                        JoinedAllocationTable,
                        PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value
                    ),
                    !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects),
                    Filter(
                        JoinedAllocationTable,
                        PersonName in SelectedEngineers.Value
                    ),
                    IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects),
                    Filter(
                        JoinedAllocationTable,
                        Projects in SelectedProjects.Value
                    ),
                    JoinedAllocationTable
                )
            );
            Clear(TempTable1);
            Clear(TempTable2);
            ClearCollect(
                SplitAllocationTable,
                ForAll(
                    FilteredJoinedAllocationTable,
                    {
                        AllocationID: ThisRecord.AllocationID,
                        PersonName: ThisRecord.PersonName,
                        ProjectName: ThisRecord.Projects,
                        Month1: If(
                            Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                            ThisRecord.Allocation
                        ),
                        Month2: If(
                            Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                            ThisRecord.Allocation
                        ),
                        Month3: If(
                            Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                            ThisRecord.Allocation
                        ),
                        Month4: If(
                            Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                            ThisRecord.Allocation
                        ),
                        Month5: If(
                            Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                            ThisRecord.Allocation
                        ),
                        Month6: If(
                            Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                            ThisRecord.Allocation
                        ),
                        Month7: If(
                            Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                            ThisRecord.Allocation
                        ),
                        Month8: If(
                            Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                            ThisRecord.Allocation
                        ),
                        Month9: If(
                            Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                            ThisRecord.Allocation
                        ),
                        Month10: If(
                            Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                            ThisRecord.Allocation
                        ),
                        Month11: If(
                            Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                            ThisRecord.Allocation
                        ),
                        Month12: If(
                            Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                            ThisRecord.Allocation
                        )
                    }
                )
            );
            ClearCollect(
                FormattedAllocationTable,
                Sort(
                    Sort(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    ( AddColumns(
                                                                        GroupBy(
                                                                            SplitAllocationTable,
                                                                            AllocationID,
                                                                            PersonName,
                                                                            ProjectName,
                                                                            subgroup
                                                                        ),
                                                                        Month1,
                                                                        Sum(
                                                                            subgroup,
                                                                            Value(Month1)
                                                                        )
                                                                    ) ),
                                                                    Month2,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month2)
                                                                    )
                                                                ),
                                                                Month3,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month3)
                                                                )
                                                            ),
                                                            Month4,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month4)
                                                            )
                                                        ),
                                                        Month5,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month5)
                                                        )
                                                    ),
                                                    Month6,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month6)
                                                    )
                                                ),
                                                Month7,
                                                Sum(
                                                    subgroup,
                                                    Value(Month7)
                                                )
                                            ),
                                            Month8,
                                            Sum(
                                                subgroup,
                                                Value(Month8)
                                            )
                                        ),
                                        Month9,
                                        Sum(
                                            subgroup,
                                            Value(Month9)
                                        )
                                    ),
                                    Month10,
                                    Sum(
                                        subgroup,
                                        Value(Month10)
                                    )
                                ),
                                Month11,
                                Sum(
                                    subgroup,
                                    Value(Month11)
                                )
                            ),
                            Month12,
                            Sum(
                                subgroup,
                                Value(Month12)
                            )
                        ),
                        ProjectName
                    ),
                    PersonName
                )
            );
            Set(
                Month1Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    ""
                )
            );
            Set(
                Month2Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    ""
                )
            );
            Set(
                Month3Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    ""
                )
            );
            Set(
                Month4Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    ""
                )
            );
            Set(
                Month5Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    ""
                )
            );
            Set(
                Month6Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    ""
                )
            );
            Set(
                Month7Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    ""
                )
            );
            Set(
                Month8Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    ""
                )
            );
            Set(
                Month9Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    ""
                )
            );
            Set(
                Month10Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    ""
                )
            );
            Set(
                Month11Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    ""
                )
            );
            Set(
                Month12Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    ""
                )
            );
            
            
            
            ClearCollect(
                SplitProjectAllocationTable,
                ForAll(
                    ProjectAllocation,
                    {
                        Project: ThisRecord.Project,
                        Month1: If(
                            Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month2: If(
                            Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month3: If(
                            Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month4: If(
                            Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month5: If(
                            Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month6: If(
                            Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month7: If(
                            Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month8: If(
                            Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month9: If(
                            Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month10: If(
                            Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month11: If(
                            Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month12: If(
                            Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                            Value(ThisRecord.Allocation)
                        )
                    }
                )
            );
            ClearCollect(
                FormattedProjectAllocationTable,
                Sort(
                    AddColumns(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                (AddColumns(
                                                                    GroupBy(
                                                                        SplitProjectAllocationTable,
                                                                        Project,
                                                                        subgroup
                                                                    ),
                                                                    Month1,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month1)
                                                                    )
                                                                )),
                                                                Month2,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month2)
                                                                )
                                                            ),
                                                            Month3,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month3)
                                                            )
                                                        ),
                                                        Month4,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month4)
                                                        )
                                                    ),
                                                    Month5,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month5)
                                                    )
                                                ),
                                                Month6,
                                                Sum(
                                                    subgroup,
                                                    Value(Month6)
                                                )
                                            ),
                                            Month7,
                                            Sum(
                                                subgroup,
                                                Value(Month7)
                                            )
                                        ),
                                        Month8,
                                        Sum(
                                            subgroup,
                                            Value(Month8)
                                        )
                                    ),
                                    Month9,
                                    Sum(
                                        subgroup,
                                        Value(Month9)
                                    )
                                ),
                                Month10,
                                Sum(
                                    subgroup,
                                    Value(Month10)
                                )
                            ),
                            Month11,
                            Sum(
                                subgroup,
                                Value(Month11)
                            )
                        ),
                        Month12,
                        Sum(
                            subgroup,
                            Value(Month12)
                        )
                    ),
                    Project
                )
            );
            ClearCollect(
                ProjectAllocationTable,
                AddColumns(
                    AddColumns(
                        AddColumns(
                            EngineerAllocation As _EngineerAllocation,
                            Name,
                            LookUp(
                                Engineers,
                                PersonID = LookUp(
                                    EngineerProjects,
                                    AllocationID = _EngineerAllocation.AllocationID,
                                    PersonID
                                ),
                                Name
                            )
                        ) As _EngineerAllocation,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = _EngineerAllocation.AllocationID,
                            Projects
                        )
                    ) As _EngineerAllocation,
                    WeightedAllocation,
                    Switch(
                        Value(_EngineerAllocation.Month),
                        1,
                        _EngineerAllocation.Allocation * 4,
                        2,
                        _EngineerAllocation.Allocation * 4,
                        3,
                        _EngineerAllocation.Allocation * 5,
                        4,
                        _EngineerAllocation.Allocation * 4,
                        5,
                        _EngineerAllocation.Allocation * 4,
                        6,
                        _EngineerAllocation.Allocation * 5,
                        7,
                        _EngineerAllocation.Allocation * 4,
                        8,
                        _EngineerAllocation.Allocation * 4,
                        9,
                        _EngineerAllocation.Allocation * 5,
                        10,
                        _EngineerAllocation.Allocation * 4,
                        11,
                        _EngineerAllocation.Allocation * 4,
                        12,
                        _EngineerAllocation.Allocation * 5,
                        _EngineerAllocation.Allocation
                    )
                )
            );
            ClearCollect(
                GroupedProjectAllocationTable,
                AddColumns(
                    GroupBy(
                        ProjectAllocationTable,
                        Projects,
                        Name,
                        subgroup
                    ) As _ProjectAllocationTable,
                    Total,
                    Round(
                        (Sum(
                            _ProjectAllocationTable.subgroup,
                            WeightedAllocation * (1 + LookUp(
                                ProjectData,
                                Project = _ProjectAllocationTable.Projects,
                                'Fees Discount'
                            )) * LookUp(
                                Engineers,
                                Name = _ProjectAllocationTable.Name,
                                Rate
                            ) * 37.5
                        ) / 1000),
                        0
                    )
                )
            );
            ClearCollect(
                ProjectTotalBookings,
                AddColumns(
                    GroupBy(
                        GroupedProjectAllocationTable,
                        Projects,
                        subgroup
                    ),
                    'SW Bookings',
                    Sum(
                        subgroup,
                        Total
                    )
                )
            );
            ClearCollect(
                ProjectDataTable,
                AddColumns(
                    ForAll(
                        ProjectData,
                        {
                            Pipeline: ThisRecord.Pipeline,
                            BU: ThisRecord.BU,
                            Team: ThisRecord.Team,
                            Project: ThisRecord.Project,
                            Description: ThisRecord.Description,
                            Account: ThisRecord.Account,
                            PL: ThisRecord.PL,
                            'Value (£k)': ThisRecord.'Value (£k)',
                            'Remaining (£k)': ThisRecord.'Remaining (£k)',
                            'Fees Discount': ThisRecord.'Fees Discount',
                            '% SW': ThisRecord.'% SW',
                            'Duration Mo': ThisRecord.'Duration Mo',
                            'Sale Date': ThisRecord.'Sale Date',
                            'Start Date': ThisRecord.'Start Date',
                            'End Date': ThisRecord.'End Date',
                            'Prob.': ThisRecord.'Prob.'
                        }
                    ) As _ProjectData,
                    'SW Bookings',
                    LookUp(
                        ProjectTotalBookings,
                        Projects = _ProjectData.Project,
                        'SW Bookings'
                    )
                )
            );
        Width: =50
        X: =197
        Y: =41
        ZIndex: =7

    WorkAllocation_ForwardMonth_Button As icon.ArrowRight:
        Height: =50
        Icon: =Icon.ArrowRight
        OnSelect: |
            =UpdateContext({Allocation_SelectedDate: DateAdd(Coalesce(Allocation_SelectedDate, Today()), 1, TimeUnit.Months)});
            
            Set(allocation1MonthText,Text(Allocation_SelectedDate,"mmmm"));
            
            Set(allocation1MonthNum,Int(Text(Allocation_SelectedDate,"mm")));
            
            Set(allocation1Year,Text(Allocation_SelectedDate,"yyyy"));
            
            
            Set(allocation2MonthText,Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"mmmm"));
            
            Set(allocation2MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"mm")));
            
            Set(allocation2Year,Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation3MonthText,Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"mmmm"));
            
            Set(allocation3MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"mm")));
            
            Set(allocation3Year,Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation4MonthText,Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"mmmm"));
            
            Set(allocation4MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"mm")));
            
            Set(allocation4Year,Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation5MonthText,Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"mmmm"));
            
            Set(allocation5MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"mm")));
            
            Set(allocation5Year,Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation6MonthText,Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"mmmm"));
            
            Set(allocation6MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"mm")));
            
            Set(allocation6Year,Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation7MonthText,Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"mmmm"));
            
            Set(allocation7MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"mm")));
            
            Set(allocation7Year,Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation8MonthText,Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"mmmm"));
            
            Set(allocation8MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"mm")));
            
            Set(allocation8Year,Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation9MonthText,Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"mmmm"));
            
            Set(allocation9MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"mm")));
            
            Set(allocation9Year,Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation10MonthText,Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"mmmm"));
            
            Set(allocation10MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"mm")));
            
            Set(allocation10Year,Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation11MonthText,Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"mmmm"));
            
            Set(allocation11MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"mm")));
            
            Set(allocation11Year,Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation12MonthText,Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"mmmm"));
            
            Set(allocation12MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"mm")));
            
            Set(allocation12Year,Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"yyyy"));
            
            
            
            
            
            
            
            //Add all columns from another table code
            
            ClearCollect(TempTable1, 
                AddColumns(
                    EngineerAllocation,
                    PersonID,
                    LookUp(EngineerProjects, AllocationID = EngineerAllocation[@AllocationID], PersonID))
            );
            
            ClearCollect(TempTable2,   
                AddColumns(
                    TempTable1,
                    Projects,
                    LookUp(EngineerProjects, AllocationID = TempTable1[@AllocationID], Projects))
            );
            
            ClearCollect(JoinedAllocationTable,
                AddColumns(
                    TempTable2,
                    PersonName,
                    LookUp(Engineers, PersonID = TempTable2[@PersonID], Name))
            );
            
            
            ClearCollect(FilteredJoinedAllocationTable, If(!IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value),
                                                            !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value),
                                                            IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, Projects in SelectedProjects.Value), 
                                                            JoinedAllocationTable));
            
            Clear(TempTable1);
            Clear(TempTable2);
            
            
            ClearCollect(SplitAllocationTable, ForAll(FilteredJoinedAllocationTable, {AllocationID: ThisRecord.AllocationID,
                                                                                PersonName:ThisRecord.PersonName,
                                                                                ProjectName:ThisRecord.Projects,
                                                                                Month1: If(Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year, ThisRecord.Allocation),
                                                                                Month2: If(Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year, ThisRecord.Allocation),
                                                                                Month3: If(Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year, ThisRecord.Allocation),
                                                                                Month4: If(Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year, ThisRecord.Allocation),
                                                                                Month5: If(Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year, ThisRecord.Allocation),
                                                                                Month6: If(Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year, ThisRecord.Allocation),
                                                                                Month7: If(Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year, ThisRecord.Allocation),
                                                                                Month8: If(Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year, ThisRecord.Allocation),
                                                                                Month9: If(Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year, ThisRecord.Allocation),
                                                                                Month10: If(Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year, ThisRecord.Allocation),
                                                                                Month11: If(Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year, ThisRecord.Allocation),
                                                                                Month12: If(Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year, ThisRecord.Allocation)}));
            
            ClearCollect(FormattedAllocationTable,
                Sort(
                    Sort(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(    
                                                    AddColumns(    
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    (
                                                                        AddColumns(
                                                                            GroupBy(SplitAllocationTable,AllocationID,PersonName,ProjectName,subgroup), Month1, Sum(subgroup,Value(Month1))
                                                                        )
                                                                    ), Month2, Sum(subgroup,Value(Month2))
                                                                ), Month3, Sum(subgroup,Value(Month3))
                                                            ), Month4, Sum(subgroup,Value(Month4))
                                                        ), Month5, Sum(subgroup,Value(Month5))
                                                    ), Month6, Sum(subgroup,Value(Month6))
                                                ), Month7, Sum(subgroup,Value(Month7))
                                            ), Month8, Sum(subgroup,Value(Month8))
                                        ), Month9, Sum(subgroup,Value(Month9))
                                    ), Month10, Sum(subgroup,Value(Month10))
                                ), Month11, Sum(subgroup,Value(Month11))
                            ),Month12, Sum(subgroup,Value(Month12))
                        ), ProjectName
                    ), PersonName
                )
            );
            Set(
                Month1Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month1
                        )
                    ),
                    ""
                )
            );
            
            Set(
                Month2Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month2
                        )
                    ),
                    ""
                )
            );
            Set(
                Month3Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month3
                        )
                    ),
                    ""
                )
            );
            Set(
                Month4Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month4
                        )
                    ),
                    ""
                )
            );
            Set(
                Month5Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month5
                        )
                    ),
                    ""
                )
            );
            Set(
                Month6Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month6
                        )
                    ),
                    ""
                )
            );
            Set(
                Month7Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month7
                        )
                    ),
                    ""
                )
            );
            Set(
                Month8Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month8
                        )
                    ),
                    ""
                )
            );
            Set(
                Month9Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month9
                        )
                    ),
                    ""
                )
            );
            Set(
                Month10Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month10
                        )
                    ),
                    ""
                )
            );
            Set(
                Month11Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month11
                        )
                    ),
                    ""
                )
            );
            Set(
                Month12Total,
                If(
                    !IsBlank(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    Text(
                        Sum(
                            FormattedAllocationTable,
                            Month12
                        )
                    ),
                    ""
                )
            );
            
            
            
            ClearCollect(
                SplitProjectAllocationTable,
                ForAll(
                    ProjectAllocation,
                    {
                        Project: ThisRecord.Project,
                        Month1: If(
                            Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month2: If(
                            Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month3: If(
                            Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month4: If(
                            Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month5: If(
                            Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month6: If(
                            Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month7: If(
                            Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month8: If(
                            Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month9: If(
                            Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month10: If(
                            Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month11: If(
                            Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month12: If(
                            Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                            Value(ThisRecord.Allocation)
                        )
                    }
                )
            );
            ClearCollect(
                FormattedProjectAllocationTable,
                Sort(
                    AddColumns(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                (AddColumns(
                                                                    GroupBy(
                                                                        SplitProjectAllocationTable,
                                                                        Project,
                                                                        subgroup
                                                                    ),
                                                                    Month1,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month1)
                                                                    )
                                                                )),
                                                                Month2,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month2)
                                                                )
                                                            ),
                                                            Month3,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month3)
                                                            )
                                                        ),
                                                        Month4,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month4)
                                                        )
                                                    ),
                                                    Month5,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month5)
                                                    )
                                                ),
                                                Month6,
                                                Sum(
                                                    subgroup,
                                                    Value(Month6)
                                                )
                                            ),
                                            Month7,
                                            Sum(
                                                subgroup,
                                                Value(Month7)
                                            )
                                        ),
                                        Month8,
                                        Sum(
                                            subgroup,
                                            Value(Month8)
                                        )
                                    ),
                                    Month9,
                                    Sum(
                                        subgroup,
                                        Value(Month9)
                                    )
                                ),
                                Month10,
                                Sum(
                                    subgroup,
                                    Value(Month10)
                                )
                            ),
                            Month11,
                            Sum(
                                subgroup,
                                Value(Month11)
                            )
                        ),
                        Month12,
                        Sum(
                            subgroup,
                            Value(Month12)
                        )
                    ),
                    Project
                )
            );
            ClearCollect(
                ProjectAllocationTable,
                AddColumns(
                    AddColumns(
                        AddColumns(
                            EngineerAllocation As _EngineerAllocation,
                            Name,
                            LookUp(
                                Engineers,
                                PersonID = LookUp(
                                    EngineerProjects,
                                    AllocationID = _EngineerAllocation.AllocationID,
                                    PersonID
                                ),
                                Name
                            )
                        ) As _EngineerAllocation,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = _EngineerAllocation.AllocationID,
                            Projects
                        )
                    ) As _EngineerAllocation,
                    WeightedAllocation,
                    Switch(
                        Value(_EngineerAllocation.Month),
                        1,
                        _EngineerAllocation.Allocation * 4,
                        2,
                        _EngineerAllocation.Allocation * 4,
                        3,
                        _EngineerAllocation.Allocation * 5,
                        4,
                        _EngineerAllocation.Allocation * 4,
                        5,
                        _EngineerAllocation.Allocation * 4,
                        6,
                        _EngineerAllocation.Allocation * 5,
                        7,
                        _EngineerAllocation.Allocation * 4,
                        8,
                        _EngineerAllocation.Allocation * 4,
                        9,
                        _EngineerAllocation.Allocation * 5,
                        10,
                        _EngineerAllocation.Allocation * 4,
                        11,
                        _EngineerAllocation.Allocation * 4,
                        12,
                        _EngineerAllocation.Allocation * 5,
                        _EngineerAllocation.Allocation
                    )
                )
            );
            ClearCollect(
                GroupedProjectAllocationTable,
                AddColumns(
                    GroupBy(
                        ProjectAllocationTable,
                        Projects,
                        Name,
                        subgroup
                    ) As _ProjectAllocationTable,
                    Total,
                    Round(
                        (Sum(
                            _ProjectAllocationTable.subgroup,
                            WeightedAllocation * (1 + LookUp(
                                ProjectData,
                                Project = _ProjectAllocationTable.Projects,
                                'Fees Discount'
                            )) * LookUp(
                                Engineers,
                                Name = _ProjectAllocationTable.Name,
                                Rate
                            ) * 37.5
                        ) / 1000),
                        0
                    )
                )
            );
            ClearCollect(
                ProjectTotalBookings,
                AddColumns(
                    GroupBy(
                        GroupedProjectAllocationTable,
                        Projects,
                        subgroup
                    ),
                    'SW Bookings',
                    Sum(
                        subgroup,
                        Total
                    )
                )
            );
            ClearCollect(
                ProjectDataTable,
                AddColumns(
                    ForAll(
                        ProjectData,
                        {
                            Pipeline: ThisRecord.Pipeline,
                            BU: ThisRecord.BU,
                            Team: ThisRecord.Team,
                            Project: ThisRecord.Project,
                            Description: ThisRecord.Description,
                            Account: ThisRecord.Account,
                            PL: ThisRecord.PL,
                            'Value (£k)': ThisRecord.'Value (£k)',
                            'Remaining (£k)': ThisRecord.'Remaining (£k)',
                            'Fees Discount': ThisRecord.'Fees Discount',
                            '% SW': ThisRecord.'% SW',
                            'Duration Mo': ThisRecord.'Duration Mo',
                            'Sale Date': ThisRecord.'Sale Date',
                            'Start Date': ThisRecord.'Start Date',
                            'End Date': ThisRecord.'End Date',
                            'Prob.': ThisRecord.'Prob.'
                        }
                    ) As _ProjectData,
                    'SW Bookings',
                    LookUp(
                        ProjectTotalBookings,
                        Projects = _ProjectData.Project,
                        'SW Bookings'
                    )
                )
            );
        Width: =50
        X: =576
        Y: =41
        ZIndex: =8

    HomeButton_Component_4 As HomeButton_Component:
        HomeScreen: =Home
        ZIndex: =9

    AssignEngineer_Container As groupContainer.manualLayoutContainer:
        Height: =75
        Width: =635
        X: =719
        Y: =23
        ZIndex: =10

        AssignEngineer_Submit As icon.Check:
            Icon: =Icon.Check
            OnSelect: |-
                =If(
                    IsEmpty(AssignEngineer_SelectedEngineer) Or IsEmpty(AssignEngineer_SelectedProject),
                    Set(AssignEngineer_Error_Text, "Please select engineer AND project"),
                
                    Set(newGUID, Text(GUID()));
                
                    Patch(EngineerProjects, 
                        Defaults(EngineerProjects), 
                        {PersonID: AssignEngineer_Engineer_Dropdown.Selected.PersonID, 
                        Projects: AssignEngineer_Project_Dropdown.Selected.Project,
                        AllocationID: newGUID}
                    );
                
                    Patch(EngineerAllocation, 
                        Defaults(EngineerAllocation), 
                        {AllocationID: newGUID,
                        Year: Year(Today()),
                        Month: Month(Today())}
                    );
                
                    Set(AssignEngineer_Error_Text, "Engineer Assigned");
                
                    Reset(AssignEngineer_Engineer_Dropdown);
                    Reset(AssignEngineer_Project_Dropdown);
                
                    //Add all columns from another table code
                
                    ClearCollect(TempTable1, 
                        AddColumns(
                            EngineerAllocation,
                            PersonID,
                            LookUp(EngineerProjects, AllocationID = EngineerAllocation[@AllocationID], PersonID))
                    );
                
                    ClearCollect(TempTable2,   
                        AddColumns(
                            TempTable1,
                            Projects,
                            LookUp(EngineerProjects, AllocationID = TempTable1[@AllocationID], Projects))
                    );
                
                    ClearCollect(JoinedAllocationTable,
                        AddColumns(
                            TempTable2,
                            PersonName,
                            LookUp(Engineers, PersonID = TempTable2[@PersonID], Name))
                    );
                
                
                    ClearCollect(FilteredJoinedAllocationTable, If(!IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value),
                                                                    !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value),
                                                                    IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, Projects in SelectedProjects.Value), 
                                                                    JoinedAllocationTable));
                
                    Clear(TempTable1);
                    Clear(TempTable2);
                
                
                    ClearCollect(SplitAllocationTable, ForAll(FilteredJoinedAllocationTable, {AllocationID: ThisRecord.AllocationID,
                                                                                        PersonName:ThisRecord.PersonName,
                                                                                        ProjectName:ThisRecord.Projects,
                                                                                        Month1: If(Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year, ThisRecord.Allocation),
                                                                                        Month2: If(Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year, ThisRecord.Allocation),
                                                                                        Month3: If(Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year, ThisRecord.Allocation),
                                                                                        Month4: If(Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year, ThisRecord.Allocation),
                                                                                        Month5: If(Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year, ThisRecord.Allocation),
                                                                                        Month6: If(Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year, ThisRecord.Allocation),
                                                                                        Month7: If(Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year, ThisRecord.Allocation),
                                                                                        Month8: If(Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year, ThisRecord.Allocation),
                                                                                        Month9: If(Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year, ThisRecord.Allocation),
                                                                                        Month10: If(Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year, ThisRecord.Allocation),
                                                                                        Month11: If(Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year, ThisRecord.Allocation),
                                                                                        Month12: If(Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year, ThisRecord.Allocation)}));
                
                    ClearCollect(FormattedAllocationTable,
                        Sort(
                            Sort(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(    
                                                            AddColumns(    
                                                                AddColumns(
                                                                    AddColumns(
                                                                        AddColumns(
                                                                            (
                                                                                AddColumns(
                                                                                    GroupBy(SplitAllocationTable,AllocationID,PersonName,ProjectName,subgroup), Month1, Sum(subgroup,Value(Month1))
                                                                                )
                                                                            ), Month2, Sum(subgroup,Value(Month2))
                                                                        ), Month3, Sum(subgroup,Value(Month3))
                                                                    ), Month4, Sum(subgroup,Value(Month4))
                                                                ), Month5, Sum(subgroup,Value(Month5))
                                                            ), Month6, Sum(subgroup,Value(Month6))
                                                        ), Month7, Sum(subgroup,Value(Month7))
                                                    ), Month8, Sum(subgroup,Value(Month8))
                                                ), Month9, Sum(subgroup,Value(Month9))
                                            ), Month10, Sum(subgroup,Value(Month10))
                                        ), Month11, Sum(subgroup,Value(Month11))
                                    ),Month12, Sum(subgroup,Value(Month12))
                                ), ProjectName
                            ), PersonName
                        )
                    );
                );
            X: =565
            Y: =3
            ZIndex: =3

        AssignEngineer_Engineer_Dropdown As combobox:
            DisplayFields: =["Name"]
            Height: =49
            InputTextPlaceholder: ="Choose Engineer..."
            Items: =Engineers
            OnChange: |-
                =ClearCollect(AssignEngineer_SelectedEngineer, Self.SelectedItems);
                ClearCollect(AssignEngineer_SelectedEngineer_Projects, Filter(EngineerProjects, PersonID in AssignEngineer_SelectedEngineer.PersonID));
                
                If(
                    IsEmpty(AssignEngineer_SelectedEngineer),
                    Reset(AssignEngineer_Project_Dropdown)
                )
            Reset: =true
            SearchFields: =["Name"]
            SearchItems: =Search(Engineers,AssignEngineer_Engineer_Dropdown.SearchText,Name)
            SelectMultiple: =false
            Width: =262
            X: =13
            Y: =12
            ZIndex: =4

        AssignEngineer_Project_Dropdown As combobox:
            DisplayFields: =["Project"]
            Height: =49
            InputTextPlaceholder: ="Choose Project..."
            Items: |-
                =If(
                    !IsEmpty(AssignEngineer_SelectedEngineer), 
                    Sort(Filter(ProjectData,Not(Project in AssignEngineer_SelectedEngineer_Projects.Projects)), Project),
                
                    [{Project: "Please Select An Engineer"}]
                )
            OnChange: =ClearCollect(AssignEngineer_SelectedProject, Self.SelectedItems)
            Reset: =true
            SearchFields: =["Project"]
            SearchItems: |-
                =Search(If(!IsEmpty(AssignEngineer_SelectedEngineer),Sort(Filter(ProjectData,Not(Project in AssignEngineer_SelectedEngineer_Projects.Projects)),Project),[{Project:"Please Select An Engineer"}]),AssignEngineer_Project_Dropdown.SearchText,Project)
            SelectMultiple: =false
            Width: =262
            X: =292
            Y: =11
            ZIndex: =5

    AssignEngineer_Error As label:
        Align: =Align.Center
        Color: =Color.Red
        Height: =29
        Text: =AssignEngineer_Error_Text
        Width: =378
        X: =823
        Y: =91
        ZIndex: =11

    AssignEngineer_Label As label:
        Align: =Align.Center
        Height: =23
        Text: ="Assign an Engineer"
        Width: =195
        X: =914
        ZIndex: =12

    WorkAllocation_Today_Button As button:
        OnSelect: |
            =UpdateContext({Allocation_SelectedDate: Today()});
            
            Set(allocation1MonthText,Text(Allocation_SelectedDate,"mmmm"));
            
            Set(allocation1MonthNum,Int(Text(Allocation_SelectedDate,"mm")));
            
            Set(allocation1Year,Text(Allocation_SelectedDate,"yyyy"));
            
            
            Set(allocation2MonthText,Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"mmmm"));
            
            Set(allocation2MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"mm")));
            
            Set(allocation2Year,Text(DateAdd(Allocation_SelectedDate, 1, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation3MonthText,Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"mmmm"));
            
            Set(allocation3MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"mm")));
            
            Set(allocation3Year,Text(DateAdd(Allocation_SelectedDate, 2, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation4MonthText,Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"mmmm"));
            
            Set(allocation4MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"mm")));
            
            Set(allocation4Year,Text(DateAdd(Allocation_SelectedDate, 3, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation5MonthText,Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"mmmm"));
            
            Set(allocation5MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"mm")));
            
            Set(allocation5Year,Text(DateAdd(Allocation_SelectedDate, 4, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation6MonthText,Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"mmmm"));
            
            Set(allocation6MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"mm")));
            
            Set(allocation6Year,Text(DateAdd(Allocation_SelectedDate, 5, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation7MonthText,Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"mmmm"));
            
            Set(allocation7MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"mm")));
            
            Set(allocation7Year,Text(DateAdd(Allocation_SelectedDate, 6, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation8MonthText,Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"mmmm"));
            
            Set(allocation8MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"mm")));
            
            Set(allocation8Year,Text(DateAdd(Allocation_SelectedDate, 7, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation9MonthText,Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"mmmm"));
            
            Set(allocation9MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"mm")));
            
            Set(allocation9Year,Text(DateAdd(Allocation_SelectedDate, 8, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation10MonthText,Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"mmmm"));
            
            Set(allocation10MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"mm")));
            
            Set(allocation10Year,Text(DateAdd(Allocation_SelectedDate, 9, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation11MonthText,Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"mmmm"));
            
            Set(allocation11MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"mm")));
            
            Set(allocation11Year,Text(DateAdd(Allocation_SelectedDate, 10, TimeUnit.Months),"yyyy"));
            
            
            
            Set(allocation12MonthText,Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"mmmm"));
            
            Set(allocation12MonthNum,Int(Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"mm")));
            
            Set(allocation12Year,Text(DateAdd(Allocation_SelectedDate, 11, TimeUnit.Months),"yyyy"));
            
            
            
            
            
            
            
            //Add all columns from another table code
            
            ClearCollect(TempTable1, 
                AddColumns(
                    EngineerAllocation,
                    PersonID,
                    LookUp(EngineerProjects, AllocationID = EngineerAllocation[@AllocationID], PersonID))
            );
            
            ClearCollect(TempTable2,   
                AddColumns(
                    TempTable1,
                    Projects,
                    LookUp(EngineerProjects, AllocationID = TempTable1[@AllocationID], Projects))
            );
            
            ClearCollect(JoinedAllocationTable,
                AddColumns(
                    TempTable2,
                    PersonName,
                    LookUp(Engineers, PersonID = TempTable2[@PersonID], Name))
            );
            
            
            ClearCollect(FilteredJoinedAllocationTable, If(!IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value And Projects in SelectedProjects.Value),
                                                            !IsEmpty(SelectedEngineers) And IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, PersonName in SelectedEngineers.Value),
                                                            IsEmpty(SelectedEngineers) And !IsEmpty(SelectedProjects), Filter(JoinedAllocationTable, Projects in SelectedProjects.Value), 
                                                            JoinedAllocationTable));
            
            Clear(TempTable1);
            Clear(TempTable2);
            
            
            ClearCollect(SplitAllocationTable, ForAll(FilteredJoinedAllocationTable, {AllocationID: ThisRecord.AllocationID,
                                                                                PersonName:ThisRecord.PersonName,
                                                                                ProjectName:ThisRecord.Projects,
                                                                                Month1: If(Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year, ThisRecord.Allocation),
                                                                                Month2: If(Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year, ThisRecord.Allocation),
                                                                                Month3: If(Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year, ThisRecord.Allocation),
                                                                                Month4: If(Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year, ThisRecord.Allocation),
                                                                                Month5: If(Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year, ThisRecord.Allocation),
                                                                                Month6: If(Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year, ThisRecord.Allocation),
                                                                                Month7: If(Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year, ThisRecord.Allocation),
                                                                                Month8: If(Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year, ThisRecord.Allocation),
                                                                                Month9: If(Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year, ThisRecord.Allocation),
                                                                                Month10: If(Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year, ThisRecord.Allocation),
                                                                                Month11: If(Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year, ThisRecord.Allocation),
                                                                                Month12: If(Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year, ThisRecord.Allocation)}));
            
            ClearCollect(FormattedAllocationTable,
                Sort(
                    Sort(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(    
                                                    AddColumns(    
                                                        AddColumns(
                                                            AddColumns(
                                                                AddColumns(
                                                                    (
                                                                        AddColumns(
                                                                            GroupBy(SplitAllocationTable,AllocationID,PersonName,ProjectName,subgroup), Month1, Sum(subgroup,Value(Month1))
                                                                        )
                                                                    ), Month2, Sum(subgroup,Value(Month2))
                                                                ), Month3, Sum(subgroup,Value(Month3))
                                                            ), Month4, Sum(subgroup,Value(Month4))
                                                        ), Month5, Sum(subgroup,Value(Month5))
                                                    ), Month6, Sum(subgroup,Value(Month6))
                                                ), Month7, Sum(subgroup,Value(Month7))
                                            ), Month8, Sum(subgroup,Value(Month8))
                                        ), Month9, Sum(subgroup,Value(Month9))
                                    ), Month10, Sum(subgroup,Value(Month10))
                                ), Month11, Sum(subgroup,Value(Month11))
                            ),Month12, Sum(subgroup,Value(Month12))
                        ), ProjectName
                    ), PersonName
                )
            );
            
            
            
            
            ClearCollect(
                SplitProjectAllocationTable,
                ForAll(
                    ProjectAllocation,
                    {
                        Project: ThisRecord.Project,
                        Month1: If(
                            Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month2: If(
                            Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month3: If(
                            Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month4: If(
                            Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month5: If(
                            Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month6: If(
                            Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month7: If(
                            Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month8: If(
                            Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month9: If(
                            Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month10: If(
                            Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month11: If(
                            Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month12: If(
                            Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                            Value(ThisRecord.Allocation)
                        )
                    }
                )
            );
            ClearCollect(
                FormattedProjectAllocationTable,
                Sort(
                    AddColumns(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                (AddColumns(
                                                                    GroupBy(
                                                                        SplitProjectAllocationTable,
                                                                        Project,
                                                                        subgroup
                                                                    ),
                                                                    Month1,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month1)
                                                                    )
                                                                )),
                                                                Month2,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month2)
                                                                )
                                                            ),
                                                            Month3,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month3)
                                                            )
                                                        ),
                                                        Month4,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month4)
                                                        )
                                                    ),
                                                    Month5,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month5)
                                                    )
                                                ),
                                                Month6,
                                                Sum(
                                                    subgroup,
                                                    Value(Month6)
                                                )
                                            ),
                                            Month7,
                                            Sum(
                                                subgroup,
                                                Value(Month7)
                                            )
                                        ),
                                        Month8,
                                        Sum(
                                            subgroup,
                                            Value(Month8)
                                        )
                                    ),
                                    Month9,
                                    Sum(
                                        subgroup,
                                        Value(Month9)
                                    )
                                ),
                                Month10,
                                Sum(
                                    subgroup,
                                    Value(Month10)
                                )
                            ),
                            Month11,
                            Sum(
                                subgroup,
                                Value(Month11)
                            )
                        ),
                        Month12,
                        Sum(
                            subgroup,
                            Value(Month12)
                        )
                    ),
                    Project
                )
            );
            ClearCollect(
                ProjectAllocationTable,
                AddColumns(
                    AddColumns(
                        AddColumns(
                            EngineerAllocation As _EngineerAllocation,
                            Name,
                            LookUp(
                                Engineers,
                                PersonID = LookUp(
                                    EngineerProjects,
                                    AllocationID = _EngineerAllocation.AllocationID,
                                    PersonID
                                ),
                                Name
                            )
                        ) As _EngineerAllocation,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = _EngineerAllocation.AllocationID,
                            Projects
                        )
                    ) As _EngineerAllocation,
                    WeightedAllocation,
                    Switch(
                        Value(_EngineerAllocation.Month),
                        1,
                        _EngineerAllocation.Allocation * 4,
                        2,
                        _EngineerAllocation.Allocation * 4,
                        3,
                        _EngineerAllocation.Allocation * 5,
                        4,
                        _EngineerAllocation.Allocation * 4,
                        5,
                        _EngineerAllocation.Allocation * 4,
                        6,
                        _EngineerAllocation.Allocation * 5,
                        7,
                        _EngineerAllocation.Allocation * 4,
                        8,
                        _EngineerAllocation.Allocation * 4,
                        9,
                        _EngineerAllocation.Allocation * 5,
                        10,
                        _EngineerAllocation.Allocation * 4,
                        11,
                        _EngineerAllocation.Allocation * 4,
                        12,
                        _EngineerAllocation.Allocation * 5,
                        _EngineerAllocation.Allocation
                    )
                )
            );
            ClearCollect(
                GroupedProjectAllocationTable,
                AddColumns(
                    GroupBy(
                        ProjectAllocationTable,
                        Projects,
                        Name,
                        subgroup
                    ) As _ProjectAllocationTable,
                    Total,
                    Round(
                        (Sum(
                            _ProjectAllocationTable.subgroup,
                            WeightedAllocation * (1 + LookUp(
                                ProjectData,
                                Project = _ProjectAllocationTable.Projects,
                                'Fees Discount'
                            )) * LookUp(
                                Engineers,
                                Name = _ProjectAllocationTable.Name,
                                Rate
                            ) * 37.5
                        ) / 1000),
                        0
                    )
                )
            );
            ClearCollect(
                ProjectTotalBookings,
                AddColumns(
                    GroupBy(
                        GroupedProjectAllocationTable,
                        Projects,
                        subgroup
                    ),
                    'SW Bookings',
                    Sum(
                        subgroup,
                        Total
                    )
                )
            );
            ClearCollect(
                ProjectDataTable,
                AddColumns(
                    ForAll(
                        ProjectData,
                        {
                            Pipeline: ThisRecord.Pipeline,
                            BU: ThisRecord.BU,
                            Team: ThisRecord.Team,
                            Project: ThisRecord.Project,
                            Description: ThisRecord.Description,
                            Account: ThisRecord.Account,
                            PL: ThisRecord.PL,
                            'Value (£k)': ThisRecord.'Value (£k)',
                            'Remaining (£k)': ThisRecord.'Remaining (£k)',
                            'Fees Discount': ThisRecord.'Fees Discount',
                            '% SW': ThisRecord.'% SW',
                            'Duration Mo': ThisRecord.'Duration Mo',
                            'Sale Date': ThisRecord.'Sale Date',
                            'Start Date': ThisRecord.'Start Date',
                            'End Date': ThisRecord.'End Date',
                            'Prob.': ThisRecord.'Prob.'
                        }
                    ) As _ProjectData,
                    'SW Bookings',
                    LookUp(
                        ProjectTotalBookings,
                        Projects = _ProjectData.Project,
                        'SW Bookings'
                    )
                )
            );
        Text: ="Today"
        X: =332
        ZIndex: =13

    ProjectListAllocation_Headers_Container As groupContainer.horizontalAutoLayoutContainer:
        Height: =50
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutJustifyContent: =LayoutJustifyContent.End
        LayoutMode: =LayoutMode.Auto
        Width: =1342
        X: =12
        Y: =150
        ZIndex: =14

        ProjectListAllocation_Pipeline_Label As label:
            Height: =50
            Size: =10
            Text: ="Pipeline"
            Width: =60
            ZIndex: =1

        ProjectListAllocation_BU_Label As label:
            Height: =50
            Size: =8
            Text: ="BU"
            Width: =25
            ZIndex: =2

        ProjectListAllocation_Team_Label As label:
            Height: =50
            Size: =8
            Text: |-
                ="Team
                "
            Width: =40
            ZIndex: =3

        ProjectListAllocation_Project_Label As label:
            Height: =50
            Size: =9
            Text: ="Project"
            Width: =60
            ZIndex: =4

        ProjectListAllocation_Description_Label As label:
            Height: =50
            Size: =10
            Text: |-
                ="Description
                "
            Width: =125
            ZIndex: =5

        ProjectListAllocation_Account_Label As label:
            Height: =50
            Size: =10
            Text: ="Account"
            Width: =75
            ZIndex: =6

        ProjectListAllocation_PL_Label As label:
            Height: =50
            Size: =10
            Text: ="PL"
            Width: =40
            ZIndex: =7

        ProjectListAllocation_SWBooking_Label As label:
            Height: =50
            Size: =10
            Text: ="SW Bookings"
            Width: =75
            ZIndex: =8

        ProjectListAllocation_Value_Label As label:
            Height: =50
            Size: =7
            Text: ="Value (£k)"
            Width: =37
            ZIndex: =9

        ProjectListAllocation_Remaining_Label As label:
            Height: =50
            Size: =7
            Text: ="Remaining (£k)"
            Width: =37
            ZIndex: =10

        ProjectListAllocation_Discount_Label As label:
            Height: =50
            Size: =9
            Text: ="Fee Discount"
            Width: =37
            ZIndex: =11

        ProjectListAllocation_PerSW_Label As label:
            Height: =50
            Size: =10
            Text: ="% SW"
            Width: =37
            ZIndex: =12

        ProjectListAllocation_Duration_Label As label:
            Height: =50
            Size: =8
            Text: ="Duration"
            Width: =37
            ZIndex: =13

        ProjectListAllocation_SaleDate_Label As label:
            Height: =50
            Size: =9
            Text: ="Sale Date"
            Width: =45
            ZIndex: =14

        ProjectListAllocation_StartDate_Label As label:
            Height: =50
            Size: =9
            Text: ="Start Date"
            Width: =45
            ZIndex: =15

        ProjectListAllocation_EndDate_Label As label:
            Height: =50
            Size: =9
            Text: ="End Date"
            Width: =45
            ZIndex: =16

        ProjectListAllocation_Probablility_Label As label:
            Height: =50
            Size: =9
            Text: |-
                ="Prob
                "
            Width: =37
            ZIndex: =17

        ProjectListAllocation_Month1_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation1MonthNum And Text(Year(Today())) = allocation1Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation1MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month1"
                )
            Width: =40
            X: =505
            Y: =152
            ZIndex: =18

        ProjectListAllocation_Month2_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation2MonthNum And Text(Year(Today())) = allocation2Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation2MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month2"
                )
            Width: =40
            X: =71
            Y: =152
            ZIndex: =19

        ProjectListAllocation_Month3_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation3MonthNum And Text(Year(Today())) = allocation3Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation3MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                "Month3"
                )
            Width: =40
            X: =142
            Y: =152
            ZIndex: =20

        ProjectListAllocation_Month4_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation4MonthNum And Text(Year(Today())) = allocation4Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation4MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month4"
                )
            Width: =40
            X: =213
            Y: =152
            ZIndex: =21

        ProjectListAllocation_Month5_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation5MonthNum And Text(Year(Today())) = allocation5Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation5MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month5"
                )
            Width: =40
            X: =284
            Y: =152
            ZIndex: =22

        ProjectListAllocation_Month6_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation6MonthNum And Text(Year(Today())) = allocation6Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation6MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month6"
                )
            Width: =40
            X: =355
            Y: =152
            ZIndex: =23

        ProjectListAllocation_Month7_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation7MonthNum And Text(Year(Today())) = allocation7Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation7MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month7"
                )
            Width: =40
            X: =423
            Y: =152
            ZIndex: =24

        ProjectListAllocation_Month8_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation8MonthNum And Text(Year(Today())) = allocation8Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation8MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month8"
                )
            Width: =40
            X: =494
            Y: =152
            ZIndex: =25

        ProjectListAllocation_Month9_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation9MonthNum And Text(Year(Today())) = allocation9Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation9MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month9"
                )
            Width: =40
            X: =565
            Y: =152
            ZIndex: =26

        ProjectListAllocation_Month10_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation10MonthNum And Text(Year(Today())) = allocation10Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation10MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month10"
                )
            Width: =40
            X: =636
            Y: =152
            ZIndex: =27

        ProjectListAllocation_Month11_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation11MonthNum And Text(Year(Today())) = allocation11Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation11MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month11"
                )
            Width: =40
            X: =707
            Y: =152
            ZIndex: =28

        ProjectListAllocation_Month12_Label As label:
            Align: =Align.Center
            BorderColor: =Color.Red
            BorderThickness: =If(Month(Today()) = allocation12MonthNum And Text(Year(Today())) = allocation12Year, 5, 0)
            Fill: =Color.Transparent
            Height: =50
            Size: =10
            Text: |-
                =Switch(allocation12MonthText, 
                "January", "Jan",
                "February", "Feb",
                "March", "Mar",
                "April", "Apr",
                "May", "May",
                "June", "Jun",
                "July", "Jul",
                "August", "Aug",
                "September", "Sep",
                "October", "Oct",
                "November", "Nov",
                "December", "Dec",
                
                "Month12"
                )
            Width: =40
            X: =778
            Y: =152
            ZIndex: =29

    CalculateProjectAllocations As button:
        FontWeight: =FontWeight.Normal
        OnSelect: |-
            =ClearCollect(_ProjectAllocation, ProjectAllocation);
            
            Set(ProjectAllocationStatusText, "Removing Allocations");
            
            ForAll(
                _ProjectAllocation,
                RemoveIf(ProjectAllocation, !IsBlank(ThisRecord.Project))
            );
            
            Set(ProjectAllocationStatusText, "Calculating Allocations");
            
            ClearCollect(CalculatedProjectAllocations, 
                {
                    Project: "templateValue",
                    Year: 0,
                    Month: 0,
                    Allocation: 0
                }
            );
            
            
            ForAll(
                ProjectData As Record,
                ForAll(
                    Sequence(
                        Record.'Duration Mo',
                        0,
                        1
                    ) As MySequnce,
            
                    Patch(
                        CalculatedProjectAllocations,
                        Defaults(CalculatedProjectAllocations),
                        {
                            Project: Record.Project,
                            Year: Year(DateAdd(Record.'Start Date', MySequnce.Value, TimeUnit.Months)),
                            Month: Month(DateAdd(Record.'Start Date', MySequnce.Value, TimeUnit.Months)),
                            Allocation: Round(
                                            If(
                                                Record.'Value (£k)' * Record.'Prob.' / Record.'Duration Mo' > 0,
                                                If(
                                                    DateAdd(Record.'Start Date', MySequnce.Value, TimeUnit.Months) < DateAdd(Today(), -30),
                                                    If(
                                                        Record.'End Date' < Today(),
                                                        Record.'Value (£k)' / Record.'Duration Mo',
                                                        ((Record.'Value (£k)' - Record.'Remaining (£k)') * Record.'Prob.' / (Month(Today()) - Month(Record.'Start Date')) )
                                                    ),
                                                    Record.'Remaining (£k)' * Record.'Prob.' /(Record.'Duration Mo' - If(
                                                            Record.'Start Date'>Today(),
                                                            0,
                                                            (Month(Today()) - Month(Record.'Start Date'))
                                                        )
                                                    )
                                                )
                                            ), 0
                                        )
                        }
                    )
                )
            );
            
            Set(ProjectAllocationStatusText, "Patching records to database");
            
            ForAll(
                CalculatedProjectAllocations,
                Patch(
                    ProjectAllocation,
                    Defaults(ProjectAllocation),
                    ThisRecord
                )
            );
            
            Set(ProjectAllocationStatusText, "Updating visible table below");
            
            
            ClearCollect(
                SplitProjectAllocationTable,
                ForAll(
                    ProjectAllocation,
                    {
                        Project: ThisRecord.Project,
                        Month1: If(
                            Int(ThisRecord.Month) = allocation1MonthNum And ThisRecord.Year = allocation1Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month2: If(
                            Int(ThisRecord.Month) = allocation2MonthNum And ThisRecord.Year = allocation2Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month3: If(
                            Int(ThisRecord.Month) = allocation3MonthNum And ThisRecord.Year = allocation3Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month4: If(
                            Int(ThisRecord.Month) = allocation4MonthNum And ThisRecord.Year = allocation4Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month5: If(
                            Int(ThisRecord.Month) = allocation5MonthNum And ThisRecord.Year = allocation5Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month6: If(
                            Int(ThisRecord.Month) = allocation6MonthNum And ThisRecord.Year = allocation6Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month7: If(
                            Int(ThisRecord.Month) = allocation7MonthNum And ThisRecord.Year = allocation7Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month8: If(
                            Int(ThisRecord.Month) = allocation8MonthNum And ThisRecord.Year = allocation8Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month9: If(
                            Int(ThisRecord.Month) = allocation9MonthNum And ThisRecord.Year = allocation9Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month10: If(
                            Int(ThisRecord.Month) = allocation10MonthNum And ThisRecord.Year = allocation10Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month11: If(
                            Int(ThisRecord.Month) = allocation11MonthNum And ThisRecord.Year = allocation11Year,
                            Value(ThisRecord.Allocation)
                        ),
                        Month12: If(
                            Int(ThisRecord.Month) = allocation12MonthNum And ThisRecord.Year = allocation12Year,
                            Value(ThisRecord.Allocation)
                        )
                    }
                )
            );
            ClearCollect(
                FormattedProjectAllocationTable,
                Sort(
                    AddColumns(
                        AddColumns(
                            AddColumns(
                                AddColumns(
                                    AddColumns(
                                        AddColumns(
                                            AddColumns(
                                                AddColumns(
                                                    AddColumns(
                                                        AddColumns(
                                                            AddColumns(
                                                                (AddColumns(
                                                                    GroupBy(
                                                                        SplitProjectAllocationTable,
                                                                        Project,
                                                                        subgroup
                                                                    ),
                                                                    Month1,
                                                                    Sum(
                                                                        subgroup,
                                                                        Value(Month1)
                                                                    )
                                                                )),
                                                                Month2,
                                                                Sum(
                                                                    subgroup,
                                                                    Value(Month2)
                                                                )
                                                            ),
                                                            Month3,
                                                            Sum(
                                                                subgroup,
                                                                Value(Month3)
                                                            )
                                                        ),
                                                        Month4,
                                                        Sum(
                                                            subgroup,
                                                            Value(Month4)
                                                        )
                                                    ),
                                                    Month5,
                                                    Sum(
                                                        subgroup,
                                                        Value(Month5)
                                                    )
                                                ),
                                                Month6,
                                                Sum(
                                                    subgroup,
                                                    Value(Month6)
                                                )
                                            ),
                                            Month7,
                                            Sum(
                                                subgroup,
                                                Value(Month7)
                                            )
                                        ),
                                        Month8,
                                        Sum(
                                            subgroup,
                                            Value(Month8)
                                        )
                                    ),
                                    Month9,
                                    Sum(
                                        subgroup,
                                        Value(Month9)
                                    )
                                ),
                                Month10,
                                Sum(
                                    subgroup,
                                    Value(Month10)
                                )
                            ),
                            Month11,
                            Sum(
                                subgroup,
                                Value(Month11)
                            )
                        ),
                        Month12,
                        Sum(
                            subgroup,
                            Value(Month12)
                        )
                    ),
                    Project
                )
            );
            ClearCollect(
                ProjectAllocationTable,
                AddColumns(
                    AddColumns(
                        AddColumns(
                            EngineerAllocation As _EngineerAllocation,
                            Name,
                            LookUp(
                                Engineers,
                                PersonID = LookUp(
                                    EngineerProjects,
                                    AllocationID = _EngineerAllocation.AllocationID,
                                    PersonID
                                ),
                                Name
                            )
                        ) As _EngineerAllocation,
                        Projects,
                        LookUp(
                            EngineerProjects,
                            AllocationID = _EngineerAllocation.AllocationID,
                            Projects
                        )
                    ) As _EngineerAllocation,
                    WeightedAllocation,
                    Switch(
                        Value(_EngineerAllocation.Month),
                        1,
                        _EngineerAllocation.Allocation * 4,
                        2,
                        _EngineerAllocation.Allocation * 4,
                        3,
                        _EngineerAllocation.Allocation * 5,
                        4,
                        _EngineerAllocation.Allocation * 4,
                        5,
                        _EngineerAllocation.Allocation * 4,
                        6,
                        _EngineerAllocation.Allocation * 5,
                        7,
                        _EngineerAllocation.Allocation * 4,
                        8,
                        _EngineerAllocation.Allocation * 4,
                        9,
                        _EngineerAllocation.Allocation * 5,
                        10,
                        _EngineerAllocation.Allocation * 4,
                        11,
                        _EngineerAllocation.Allocation * 4,
                        12,
                        _EngineerAllocation.Allocation * 5,
                        _EngineerAllocation.Allocation
                    )
                )
            );
            ClearCollect(
                GroupedProjectAllocationTable,
                AddColumns(
                    GroupBy(
                        ProjectAllocationTable,
                        Projects,
                        Name,
                        subgroup
                    ) As _ProjectAllocationTable,
                    Total,
                    Round(
                        (Sum(
                            _ProjectAllocationTable.subgroup,
                            WeightedAllocation * (1 + LookUp(
                                ProjectData,
                                Project = _ProjectAllocationTable.Projects,
                                'Fees Discount'
                            )) * LookUp(
                                Engineers,
                                Name = _ProjectAllocationTable.Name,
                                Rate
                            ) * 37.5
                        ) / 1000),
                        0
                    )
                )
            );
            ClearCollect(
                ProjectTotalBookings,
                AddColumns(
                    GroupBy(
                        GroupedProjectAllocationTable,
                        Projects,
                        subgroup
                    ),
                    'SW Bookings',
                    Sum(
                        subgroup,
                        Total
                    )
                )
            );
            ClearCollect(
                ProjectDataTable,
                AddColumns(
                    ForAll(
                        ProjectData,
                        {
                            Pipeline: ThisRecord.Pipeline,
                            BU: ThisRecord.BU,
                            Team: ThisRecord.Team,
                            Project: ThisRecord.Project,
                            Description: ThisRecord.Description,
                            Account: ThisRecord.Account,
                            PL: ThisRecord.PL,
                            'Value (£k)': ThisRecord.'Value (£k)',
                            'Remaining (£k)': ThisRecord.'Remaining (£k)',
                            'Fees Discount': ThisRecord.'Fees Discount',
                            '% SW': ThisRecord.'% SW',
                            'Duration Mo': ThisRecord.'Duration Mo',
                            'Sale Date': ThisRecord.'Sale Date',
                            'Start Date': ThisRecord.'Start Date',
                            'End Date': ThisRecord.'End Date',
                            'Prob.': ThisRecord.'Prob.'
                        }
                    ) As _ProjectData,
                    'SW Bookings',
                    LookUp(
                        ProjectTotalBookings,
                        Projects = _ProjectData.Project,
                        'SW Bookings'
                    )
                )
            );
            
            Set(ProjectAllocationStatusText, "");
        Size: =11
        Text: |-
            ="Calculate Project Allocations
            "
        Width: =138
        X: =1216
        Y: =105
        ZIndex: =16

    ProjectAllocationStatus As label:
        Align: =Align.Center
        Color: =Color.Red
        Text: =ProjectAllocationStatusText
        Width: =393
        X: =486
        Y: =104
        ZIndex: =17

    ProjectAllocation_TotalsContainer As groupContainer.manualLayoutContainer:
        Height: =30
        X: =854
        Y: =497
        ZIndex: =18

        ProjectAllocation_Month1_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month1
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month1
                        )
                    ),
                    2
                )
            Width: =40
            X: =21
            ZIndex: =1

        ProjectAllocation_Month2_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month2
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month2
                        )
                    ),
                    2
                )
            Width: =40
            X: =61
            ZIndex: =2

        ProjectAllocation_Month3_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month3
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month3
                        )
                    ),
                    2
                )
            Width: =40
            X: =101
            ZIndex: =3

        ProjectAllocation_Month4_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month4
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month4
                        )
                    ),
                    2
                )
            Width: =40
            X: =141
            ZIndex: =4

        ProjectAllocation_Month5_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month5
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month5
                        )
                    ),
                    2
                )
            Width: =40
            X: =181
            ZIndex: =5

        ProjectAllocation_Month6_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month6
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month6
                        )
                    ),
                    2
                )
            Width: =40
            X: =221
            ZIndex: =6

        ProjectAllocation_Month7_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month7
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month7
                        )
                    ),
                    2
                )
            Width: =40
            X: =261
            ZIndex: =7

        ProjectAllocation_Month8_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month8
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month8
                        )
                    ),
                    2
                )
            Width: =40
            X: =300
            ZIndex: =8

        ProjectAllocation_Month9_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month9
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month9
                        )
                    ),
                    2
                )
            Width: =40
            X: =340
            ZIndex: =9

        ProjectAllocation_Month10_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month10
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month10
                        )
                    ),
                    2
                )
            Width: =40
            X: =380
            ZIndex: =10

        ProjectAllocation_Month11_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month11
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month11
                        )
                    ),
                    2
                )
            Width: =40
            X: =420
            ZIndex: =11

        ProjectAllocation_Month12_Label_Total As label:
            Align: =Align.Center
            Fill: |-
                =If(
                    IsEmpty(SelectedEngineers) Or CountRows(SelectedEngineers) > 1 Or Self.Text = "",
                    Color.Transparent,
                    
                    If(
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 0.5), 
                        Color.LightGreen,
                        
                        Value(Self.Text) <= (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.SandyBrown,
                        
                        Value(Self.Text) > (CountRows(Distinct(FormattedAllocationTable, PersonName)) * 1),
                        Color.PaleVioletRed,
                        
                        Color.Transparent
                    )
                )
            Height: =30
            Size: =7
            Text: |-
                =Round(
                    If(
                        !IsBlank(AvgFee),
                        Sum(
                            FormattedProjectAllocationTable,
                            Month12
                        ) / AvgFee,
                        Sum(
                            FormattedProjectAllocationTable,
                            Month12
                        )
                    ),
                    2
                )
            Width: =40
            X: =460
            ZIndex: =12

    AverageFee_Container As groupContainer.manualLayoutContainer:
        Height: =30
        Width: =351
        X: =497
        Y: =497
        ZIndex: =19

        AverageFee_Label As label:
            Height: =30
            Size: =11
            Text: |-
                ="Average Fee (£): "
            Width: =130
            X: =15
            ZIndex: =1

        "'Average Fee_Input' As text":
            BorderThickness: =1
            Default: =
            Format: =TextFormat.Number
            Height: =25
            OnChange: |+
                =Set(AvgFee, Self.Text);
                
            Size: =11
            Width: =206
            X: =145
            Y: =2
            ZIndex: =2

